<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hammer Tracker - Travian Tools</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Vollkorn:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../css/style.css">
    <style>
        .calc-wrapper { max-width: 1200px; margin: 0 auto; }
        
        /* --- SETTINGS BAR --- */
        .settings-bar { 
            background: #fff; padding: 15px; border-radius: 8px; border: 1px solid #c9b7a2; 
            margin-bottom: 20px; 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 15px;
        }
        .settings-bar label { display: block; font-size: 0.7rem; font-weight: bold; color: #777; margin-bottom: 4px; text-transform: uppercase; }
        .settings-bar select, .settings-bar input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-weight: bold; color: #333; box-sizing: border-box; }

        /* --- TIME CONTROL BAR --- */
        .time-bar {
            background: #e3f2fd; border: 1px solid #90caf9; padding: 20px; border-radius: 8px; margin-bottom: 25px;
            display: flex; gap: 25px; align-items: flex-end; flex-wrap: wrap;
        }
        .time-group { flex: 1; min-width: 220px; }
        .time-group label { display: block; font-size: 0.75rem; font-weight: bold; color: #1565c0; margin-bottom: 5px; text-transform: uppercase; }
        .time-group input { width: 100%; padding: 10px; border: 1px solid #bbdefb; border-radius: 4px; font-family: 'Roboto', sans-serif; font-weight: bold; box-sizing: border-box; }
        
        .time-display { flex: 0.5; text-align: right; min-width: 150px; display: flex; flex-direction: column; justify-content: center; }
        .elapsed-label { font-size: 0.75rem; color: #555; text-transform: uppercase; margin-bottom: 4px; }
        .elapsed-val { font-size: 1.6rem; font-weight: bold; color: #1565c0; font-family: 'Roboto', sans-serif; }

        /* --- CARDS --- */
        .training-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .train-card { background: #fff; border: 1px solid #c9b7a2; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; }
        .card-header { padding: 12px 15px; font-family: 'Vollkorn', serif; font-weight: bold; font-size: 1.1rem; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .header-inf { background-color: #e8f5e9; color: #2e7d32; border-bottom-color: #c8e6c9; }
        .header-cav { background-color: #fff3e0; color: #ef6c00; border-bottom-color: #ffe0b2; }
        .header-sie { background-color: #f3e5f5; color: #7b1fa2; border-bottom-color: #e1bee7; }

        .card-body { padding: 20px; flex: 1; }
        
        .card-top-row { display: flex; gap: 10px; margin-bottom: 15px; }
        .unit-select { flex: 2; padding: 10px; font-size: 1rem; border: 1px solid #ccc; border-radius: 4px; font-weight: bold; }
        .helmet-select { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-weight: bold; color: #555; }

        /* Snapshot Input (GREY THEME) */
        .snapshot-row { 
            background: #f5f5f5; padding: 10px; border-radius: 4px; margin-bottom: 15px; 
            border: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center; 
        }
        .snapshot-row label { font-size: 0.8rem; font-weight: bold; color: #616161; text-transform: uppercase; }
        .snapshot-row input { width: 80px; padding: 6px; text-align: center; border: 1px solid #bdbdbd; border-radius: 4px; font-weight: bold; color: #424242; background: #fff; }

        .input-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed #eee; }
        .input-row label { font-size: 0.9rem; font-weight: bold; color: #555; }
        .input-row select { width: 70px; padding: 6px; text-align: center; border: 1px solid #ccc; border-radius: 4px; font-weight: bold; }
        
        /* Projection Row (BLUE-GREY THEME) */
        .projection-row { 
            display: flex; justify-content: space-between; align-items: center; 
            font-size: 0.85rem; color: #455a64; background: #eceff1; 
            padding: 8px 10px; border-radius: 4px; margin-bottom: 5px; border: 1px solid #cfd8dc;
        }
        .proj-val { font-weight: bold; color: #37474f; }

        /* Card Footer */
        .card-footer { background-color: #fafafa; border-top: 1px solid #eee; padding: 15px; }
        .total-box { background: #333; color: #fff; padding: 10px; border-radius: 4px; text-align: center; margin-bottom: 10px; }
        .total-box label { display: block; font-size: 0.7rem; text-transform: uppercase; color: #aaa; margin-bottom: 2px; }
        .total-box .big-num { font-size: 1.4rem; font-weight: bold; font-family: 'Roboto', sans-serif; }
        .total-box .sub-text { font-size: 0.8rem; color: #ccc; }

        /* Global Summary Tiles */
        .results-box { background: #333; color: #fff; padding: 20px; border-radius: 8px; }
        .group-title { font-size: 0.85rem; text-transform: uppercase; color: #859f51; border-bottom: 1px solid #555; padding-bottom: 5px; margin-bottom: 10px; letter-spacing: 1px; font-weight: bold; }
        
        .tiles-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; }
        .stat-tile { 
            background: rgba(255,255,255,0.08); border-radius: 6px; padding: 12px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;
            border: 1px solid rgba(255,255,255,0.05); min-height: 70px;
        }
        .tile-label { font-size: 0.65rem; text-transform: uppercase; color: #aaa; margin-bottom: 5px; }
        .tile-val { font-size: 1.1rem; font-weight: bold; font-family: 'Roboto', sans-serif; }
        .tile-sub { font-size: 0.75rem; color: #888; margin-top: 3px; }
        
        /* Colors */
        .c-wood { color: #a5d6a7; }
        .c-clay { color: #ffcc80; }
        .c-iron { color: #b0bec5; }
        .c-crop { color: #fff59d; }
        .c-off { color: #ffab91; }
        .c-def { color: #90caf9; }
        .c-upkeep { color: #fdd835 !important; }

        /* Resource Grid - 4 cols on desktop, 2 on mobile */
        .res-breakdown-grid { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 10px; 
        }

        @media (max-width: 600px) {
            .training-grid { grid-template-columns: 1fr; }
            .card-top-row { flex-direction: column; gap: 10px; }
            .helmet-select, .unit-select { width: 100%; }
            .time-bar { flex-direction: column; align-items: stretch; gap: 15px; }
            .time-display { text-align: left; margin-top: 10px; border-top: 1px solid #bbdefb; padding-top: 15px; }
            /* Mobile response: 2 cols for resources */
            .res-breakdown-grid { grid-template-columns: 1fr 1fr; } 
            .footer-tiles { grid-template-columns: 1fr 1fr; }
            .tiles-grid { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>

<div class="container calc-wrapper">
    <div style="margin-bottom: 20px;">
        <a href="../../index.html" style="text-decoration: none; color: #859f51; font-weight: bold;">&larr; Back to Hub</a>
    </div>

    <h1>Hammer Tracker & Projector</h1>
    <p>Enter the troops from a spy/battle report and see how many they could have now.</p>
    
    <div class="time-bar">
        <div class="time-group">
            <label>üìÖ Report Date/Time (Snapshot)</label>
            <input type="datetime-local" id="time_snapshot" oninput="HammerApp.calculate()">
        </div>
        <div class="time-group">
            <label>üéØ Projection Target (Default: Now)</label>
            <input type="datetime-local" id="time_target" oninput="HammerApp.calculate()">
        </div>
        <div class="time-display">
            <span class="elapsed-label">Elapsed Time</span>
            <span class="elapsed-val" id="disp_elapsed">0d 0h</span>
        </div>
    </div>

    <div class="settings-bar">
        <div>
            <label>TRIBE</label>
            <select id="tribeSelect" onchange="HammerApp.updateUnitDropdowns()"></select>
        </div>
        <div>
            <label>SERVER SPEED</label>
            <select id="serverSpeed" onchange="HammerApp.calculate()">
                <option value="1">1x</option>
                <option value="2">2x</option>
                <option value="3">3x</option>
                <option value="5">5x</option>
                <option value="10">10x</option>
            </select>
        </div>
        <div>
            <label>ALLIANCE BONUS</label>
            <select id="allyBonus" onchange="HammerApp.calculate()">
                <option value="0">0%</option>
                <option value="0.02">2%</option>
                <option value="0.04">4%</option>
                <option value="0.06">6%</option>
                <option value="0.08">8%</option>
                <option value="0.10">10%</option>
            </select>
        </div>
        <div>
            <label>ARTIFACT</label>
            <select id="artifact" onchange="HammerApp.calculate()">
                <option value="1.0">None (100% Time)</option>
                <option value="0.75">Small (75% Time)</option>
                <option value="0.5">Unique (50% Time)</option>
            </select>
        </div>
    </div>

    <div class="training-grid">
        
        <div class="train-card">
            <div class="card-header header-inf">
                <span>‚öîÔ∏è Infantry</span>
            </div>
            <div class="card-body">
                <div class="card-top-row">
                    <select id="unit_infantry" class="unit-select" onchange="HammerApp.calculate()"></select>
                    <select id="inf_helmet" class="helmet-select" onchange="HammerApp.calculate()">
                        <option value="0">Helm: 0%</option>
                        <option value="10">Helm: 10%</option>
                        <option value="15">Helm: 15%</option>
                        <option value="20">Helm: 20%</option>
                    </select>
                </div>
                
                <div class="snapshot-row">
                    <label>Snapshot Count</label>
                    <input type="number" id="snap_inf" value="0" min="0" oninput="HammerApp.calculate()">
                </div>

                <div class="input-row">
                    <label>Barracks Level</label>
                    <select id="lvl_barracks" onchange="HammerApp.calculate()"></select>
                </div>
                <div class="input-row">
                    <label>Great Barracks Level</label>
                    <select id="lvl_gb" onchange="HammerApp.calculate()"></select>
                </div>

                <div class="projection-row">
                    <span>Training since report:</span>
                    <span class="proj-val" id="proj_inf">+0</span>
                </div>
            </div>
            <div class="card-footer">
                <div class="total-box">
                    <label>PROJECTED TOTAL</label>
                    <div class="big-num" id="total_inf">0</div>
                    <div class="sub-text" id="lbl_inf">Infantry</div>
                </div>
            </div>
        </div>

        <div class="train-card">
            <div class="card-header header-cav">
                <span>üêé Cavalry</span>
            </div>
            <div class="card-body">
                <div class="card-top-row">
                    <select id="unit_cavalry" class="unit-select" onchange="HammerApp.calculate()"></select>
                    <select id="cav_helmet" class="helmet-select" onchange="HammerApp.calculate()">
                        <option value="0">Helm: 0%</option>
                        <option value="10">Helm: 10%</option>
                        <option value="15">Helm: 15%</option>
                        <option value="20">Helm: 20%</option>
                    </select>
                </div>
                
                <div class="snapshot-row">
                    <label>Snapshot Count</label>
                    <input type="number" id="snap_cav" value="0" min="0" oninput="HammerApp.calculate()">
                </div>

                <div class="input-row">
                    <label>Stable Level</label>
                    <select id="lvl_stable" onchange="HammerApp.calculate()"></select>
                </div>
                <div class="input-row">
                    <label>Great Stable Level</label>
                    <select id="lvl_gs" onchange="HammerApp.calculate()"></select>
                </div>

                <div class="projection-row">
                    <span>Training since report:</span>
                    <span class="proj-val" id="proj_cav">+0</span>
                </div>
            </div>
            <div class="card-footer">
                <div class="total-box">
                    <label>PROJECTED TOTAL</label>
                    <div class="big-num" id="total_cav">0</div>
                    <div class="sub-text" id="lbl_cav">Cavalry</div>
                </div>
            </div>
        </div>

        <div class="train-card">
            <div class="card-header header-sie">
                <span>üèöÔ∏è Siege</span>
            </div>
            <div class="card-body">
                <div class="card-top-row">
                    <select id="unit_siege" class="unit-select" style="flex:1;" onchange="HammerApp.calculate()"></select>
                    <div style="flex:0.5;"></div>
                </div>
                
                <div class="snapshot-row">
                    <label>Snapshot Count</label>
                    <input type="number" id="snap_siege" value="0" min="0" oninput="HammerApp.calculate()">
                </div>

                <div class="input-row">
                    <label>Workshop Level</label>
                    <select id="lvl_workshop" onchange="HammerApp.calculate()"></select>
                </div>
                
                <div style="height:53px;"></div> <div class="projection-row">
                    <span>Training since report:</span>
                    <span class="proj-val" id="proj_siege">+0</span>
                </div>
            </div>
            <div class="card-footer">
                <div class="total-box">
                    <label>PROJECTED TOTAL</label>
                    <div class="big-num" id="total_siege">0</div>
                    <div class="sub-text" id="lbl_siege">Siege</div>
                </div>
            </div>
        </div>
    </div>

    <div class="results-box">
        
        <div class="summary-group">
            <div class="group-title">Projected Army Strength</div>
            <div class="tiles-grid" style="grid-template-columns: repeat(3, 1fr);">
                <div class="stat-tile">
                    <span class="tile-label" id="lbl_inf">INFANTRY</span>
                    <span class="tile-val" id="global_inf">0</span>
                </div>
                <div class="stat-tile">
                    <span class="tile-label" id="lbl_cav">CAVALRY</span>
                    <span class="tile-val" id="global_cav">0</span>
                </div>
                <div class="stat-tile">
                    <span class="tile-label" id="lbl_siege">SIEGE</span>
                    <span class="tile-val" id="global_siege">0</span>
                </div>
            </div>
            <div class="tiles-grid" style="margin-top:10px; grid-template-columns: repeat(4, 1fr);">
                <div class="stat-tile">
                    <span class="tile-label">TOTAL OFFENSE</span>
                    <span class="tile-val c-off" id="global_off">0k</span>
                </div>
                <div class="stat-tile">
                    <span class="tile-label">DEFENSE VS INFANTRY</span>
                    <span class="tile-val c-def" id="global_def_inf">0k</span>
                </div>
                <div class="stat-tile">
                    <span class="tile-label">DEFENSE VS CAVALRY</span>
                    <span class="tile-val c-def" id="global_def_cav">0k</span>
                </div>
                <div class="stat-tile">
                    <span class="tile-label">TOTAL UPKEEP</span>
                    <span class="tile-val c-upkeep"><span id="global_upkeep">0</span>/h</span>
                </div>
            </div>
        </div>

        <div class="summary-group">
            <div class="group-title">Estimated Cost of Growth</div>
            <div class="res-breakdown-grid">
                 <div class="stat-tile">
                    <span class="tile-label">üå≤ WOOD</span>
                    <span class="tile-val c-wood" id="growth_wood">0</span>
                </div>
                 <div class="stat-tile">
                    <span class="tile-label">üß± CLAY</span>
                    <span class="tile-val c-clay" id="growth_clay">0</span>
                </div>
                 <div class="stat-tile">
                    <span class="tile-label">‚öíÔ∏è IRON</span>
                    <span class="tile-val c-iron" id="growth_iron">0</span>
                </div>
                 <div class="stat-tile">
                    <span class="tile-label">üåæ CROP</span>
                    <span class="tile-val c-crop" id="growth_crop">0</span>
                </div>
            </div>
            <div class="tiles-grid" style="margin-top:10px; grid-template-columns: 1fr 1fr;">
                <div class="stat-tile">
                    <span class="tile-label">TOTAL RESOURCES SPENT</span>
                    <span class="tile-val" id="global_growth_cost">0</span>
                </div>
                <div class="stat-tile">
                    <span class="tile-label">TIME SPAN</span>
                    <span class="tile-val" style="color:#eee;" id="footer_time_span">0d 0h</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="data.js"></script>
<script src="app.js"></script>
</body>
</html>